(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
module.exports=function(t){t.Prefabs.Bullet=function(t,s,i,e,o){this.BULLET_SPEED=500,this.player=e,this.game=e.game,Phaser.Sprite.call(this,e.game,0,0,"bullet"),this.anchor.setTo(.5,.5),this.game.physics.enable(this,Phaser.Physics.ARCADE),this.angle=-Math.PI/2,this.kill(),this.laserSound=this.game.add.audio("laserFx"),this.checkWorldBounds=!0,this.outOfBoundsKill=!0,o&&this.events.onKilled.add(o,this)},t.Prefabs.Bullet.prototype=Object.create(Phaser.Sprite.prototype),t.Prefabs.Bullet.constructor=t.Prefabs.Bullet,t.Prefabs.Bullet.prototype.shoot=function(){this.rotation=this.player.rotation,this.xVel=Math.cos(this.rotation)*this.BULLET_SPEED,this.yVel=Math.sin(this.rotation)*this.BULLET_SPEED,this.laserSound.play()},t.Prefabs.Bullet.prototype.shootFrom=function(t){this.rotation=t.rotation,this.xVel=Math.cos(this.rotation)*this.BULLET_SPEED,this.yVel=Math.sin(this.rotation)*this.BULLET_SPEED},t.Prefabs.Bullet.prototype.update=function(){var t=this;t.body.velocity.x=this.xVel,t.body.velocity.y=this.yVel}};
},{}],2:[function(require,module,exports){
module.exports=function(e){e.Prefabs.Enemies=function(t,i,s,n,r){var h=this.desc=s;Phaser.Group.call(this,t,r),this.count=i=i||5,this.livingEnemies=i,this.killedAll=!0;for(var a,o=0;i>o;o++)a=this.add(new e.Prefabs.Enemy(this.game,0,0,h,a||n)),a.x=a?a.x:this.game.rnd.integerInRange(a.width,t.width-a.width),a.y=-(this.game.height+a.height/2+o*a.height)},e.Prefabs.Enemies.prototype=Object.create(Phaser.Group.prototype),e.Prefabs.Enemies.constructor=e.Prefabs.Enemies,e.Prefabs.Enemies.prototype.update=function(){this.callAll("update")},e.Prefabs.Enemies.prototype.reset=function(e,t,i){this.exists=!0,this.livingEnemies=this.count,this.killedAll=!0;var s=0;this.forEach(function(n){0===s&&n.resetTarget(t),n.reload(s,e,i),s++},this)},e.Prefabs.Enemies.prototype.updateStatus=function(e,t){if(this.livingEnemies--,t&&(this.killedAll=!1),0===this.livingEnemies&&(this.exists=!1,this.killedAll)){var i=this.game.rnd.integerInRange(1,this.count);1===i&&this.game.state.getCurrentState().addBonus(e)}}};
},{}],3:[function(require,module,exports){
module.exports=function(t){t.Prefabs.Enemy=function(t,e,s,i,h){var i=this.desc=i,a="enemy_"+i.type||"1";Phaser.Sprite.call(this,t,e,s,a),this.speed=i.speed,this.target=h,this.dead=!1,this.minDistance=10,this.explosion=this.game.add.sprite(0,0,"explosion"),this.explosion.anchor.setTo(.5,.5),this.explosion.alpha=0,this.anchor.setTo(.5,.5),this.game.physics.enable(this,Phaser.Physics.ARCADE),this.events.onOutOfBounds.add(function(){this.die(!0)},this)},t.Prefabs.Enemy.prototype=Object.create(Phaser.Sprite.prototype),t.Prefabs.Enemy.constructor=t.Prefabs.Enemy,t.Prefabs.Enemy.prototype.update=function(){if(!t.paused){var e,s;e=this.game.math.distance(this.x,this.y,this.target.x,this.target.y),e>this.minDistance?(s=this.game.math.angleBetween(this.x,this.y,this.target.x,this.target.y),this.body.velocity.x=Math.cos(s)*this.speed,this.body.velocity.y=-(Math.sin(s)*this.speed)):this.body.velocity.setTo(0,0),this.y<this.game.height&&!this.checkWorldBounds&&(this.checkWorldBounds=!0)}},t.Prefabs.Enemy.prototype.die=function(t){this.dead||(this.dead=!0,this.alpha=0,t||(this.explosion.reset(this.x,this.y),this.explosion.angle=this.game.rnd.integerInRange(0,360),this.explosion.alpha=0,this.explosion.scale.x=.2,this.explosion.scale.y=.2,this.game.add.tween(this.explosion).to({alpha:1,angle:"+30"},200,Phaser.Easing.Linear.NONE,!0,0).to({alpha:0,angle:"+30"},300,Phaser.Easing.Linear.NONE,!0,0),this.game.add.tween(this.explosion.scale).to({x:1.5,y:1.5},500,Phaser.Easing.Cubic.Out,!0,0)),this.parent.updateStatus(this,t))},t.Prefabs.Enemy.prototype.pause=function(){this.body.velocity.x=0,this.body.velocity.y=0},t.Prefabs.Enemy.prototype.reload=function(t,e){this.x=e,this.checkWorldBounds=!1,this.dead=!1,this.alpha=1,this.y=-this.height+t*this.height},t.Prefabs.Enemy.prototype.resetTarget=function(t){this.target=new Phaser.Point(this.x||this.game.width/2,t)}};
},{}],4:[function(require,module,exports){
module.exports=function(t){t.Prefabs.GameoverPanel=function(e,i){Phaser.Group.call(this,e,i),this.panel=this.game.add.sprite(0,0,"panel"),this.panel.width=this.game.width/2,this.panel.height=150,this.add(this.panel);var h=t.winner?"You won!":"You lost :(";this.textPause=this.game.add.bitmapText(e.width/2,-50,"architectsDaughter",h,28),this.textPause.position.x=this.game.width/2-this.textPause.textWidth/2,this.add(this.textPause),this.textScore=this.game.add.bitmapText(e.width/2,80,"architectsDaughter","Score : 0",22),this.textScore.position.x=this.game.width/2-this.textScore.textWidth/2,this.add(this.textScore),this.textHighScore=this.game.add.bitmapText(e.width/2,105,"architectsDaughter","High Score : 0",22),this.textHighScore.position.x=this.game.width/2-this.textHighScore.textWidth/2,this.add(this.textHighScore),this.y=-80,this.x=0,this.alpha=0,this.btnReplay=this.game.add.button(this.game.width/2-32,15,"btn",this.replay,this,3,2,3,2),this.btnReplay.anchor.setTo(.5,0),this.add(this.btnReplay),this.btnMenu=this.game.add.button(this.game.width/2+28,15,"btn",function(){this.game.state.getCurrentState().goToMenu()},this,5,4,5,4),this.btnMenu.anchor.setTo(.5,0),this.add(this.btnMenu)},t.Prefabs.GameoverPanel.prototype=Object.create(Phaser.Group.prototype),t.Prefabs.GameoverPanel.constructor=t.Prefabs.GameoverPanel,t.Prefabs.GameoverPanel.prototype.show=function(e){e=e||0;var i,h=!1;console.log("winner",t.winner),localStorage.setItem("highScore",0),localStorage?(i=parseInt(localStorage.getItem("highScore"),10),(!i||e>i)&&(i=e,localStorage.setItem("highScore",i.toString()),e>0&&(h=!0,this.newScore=this.game.add.sprite(0,120,"new"),this.newScore.anchor.setTo(.5,.5),this.add(this.newScore)))):i=0,this.textHighScore.setText("High Score: "+i.toString());var s="Score: "+e.toString();this.textScore.setText(s),this.textScore.update(),this.textScore.position.x=this.game.width/2-this.textScore.textWidth/2,this.textHighScore.update(),this.textHighScore.position.x=this.game.width/2-this.textHighScore.textWidth/2,this.panel.position.x=this.game.width/2-this.panel.width/2,h&&(this.newScore.x=this.textHighScore.position.x-30),this.game.add.tween(this).to({alpha:1,y:this.game.height/2-this.panel.height/2},1e3,Phaser.Easing.Exponential.Out,!0,0)},t.Prefabs.GameoverPanel.prototype.replay=function(){t.reset(),t.multiplayer=!0,this.game.state.start("Play")}};
},{}],5:[function(require,module,exports){
module.exports=function(e){require("./player")(e),require("./gameover_panel")(e),require("./pause_panel")(e),require("./enemies")(e),require("./enemy")(e),require("./laser")(e),require("./bullet")(e)};
},{"./bullet":1,"./enemies":2,"./enemy":3,"./gameover_panel":4,"./laser":6,"./pause_panel":7,"./player":8}],6:[function(require,module,exports){
module.exports=function(e){e.Prefabs.Laser=function(e,s,t){Phaser.Sprite.call(this,e,s,t,"laser"),this.anchor.setTo(.5,.5),this.speed=150,this.checkWorldBounds=!0,this.outOfBoundsKill=!0,this.game.physics.enable(this,Phaser.Physics.ARCADE),this.tween=this.game.add.tween(this).to({angle:-360},3e3,Phaser.Easing.Linear.NONE,!0,0,Number.POSITIVE_INFINITY)},e.Prefabs.Laser.prototype=Object.create(Phaser.Sprite.prototype),e.Prefabs.Laser.constructor=e.Prefabs.Laser,e.Prefabs.Laser.prototype.update=function(){e.paused?this.body.velocity.x=0:this.body.velocity.x=-this.speed},e.Prefabs.Laser.prototype.reload=function(e){this.alpha=1,this.speed=e,this.scale.x=1,this.scale.y=1},e.Prefabs.Laser.prototype.die=function(){this.game.add.tween(this).to({alpha:0},150,Phaser.Easing.Cubic.Out,!0,0),this.game.add.tween(this.scale).to({x:1.5,y:1.5},150,Phaser.Easing.Cubic.Out,!0,0)},e.Prefabs.Laser.prototype.pause=function(){this.tween.pause()},e.Prefabs.Laser.prototype.resume=function(){this.tween.resume()}};
},{}],7:[function(require,module,exports){
module.exports=function(t){t.Prefabs.PausePanel=function(t,e){Phaser.Group.call(this,t,e),this.panel=this.game.add.sprite(0,0,"panel"),this.panel.width=480,this.panel.height=80,this.add(this.panel),this.textPause=this.game.add.bitmapText(t.width/2,-42,"kenpixelblocks","Pause",28),this.textPause.position.x=this.game.width/2-this.textPause.textWidth/2,this.add(this.textPause),this.y=-80,this.x=0,this.alpha=0,this.btnPlay=this.game.add.button(this.game.width/2-32,15,"btn",this.unPause,this,3,2,3,2),this.btnPlay.anchor.setTo(.5,0),this.add(this.btnPlay),this.btnMenu=this.game.add.button(this.game.width/2+28,15,"btn",function(){this.game.state.getCurrentState().goToMenu()},this,5,4,5,4),this.btnMenu.anchor.setTo(.5,0),this.add(this.btnMenu)},t.Prefabs.PausePanel.prototype=Object.create(Phaser.Group.prototype),t.Prefabs.PausePanel.constructor=t.Prefabs.PausePanel,t.Prefabs.PausePanel.prototype.show=function(){this.game.add.tween(this).to({alpha:1,y:this.game.height/2-this.panel.height/2},1e3,Phaser.Easing.Exponential.Out,!0,0)},t.Prefabs.PausePanel.prototype.unPause=function(){this.game.add.tween(this).to({alpha:0,y:-80},1e3,Phaser.Easing.Exponential.Out,!0,0),this.game.state.getCurrentState().playGame()}};
},{}],8:[function(require,module,exports){
module.exports=function(t){t.Prefabs.Player=function(t,e,i,s,h){this.id=h,s?(Phaser.Sprite.call(this,t,e,i,"hero"),this.target=s,this.follow=!1,this.minDistance=10,this.speed=200,this.lives=3,this.shotDelay=100,this.numBullets=10,this.timerBullet,this.shieldsEnabled=!1,this.timerShield,this.shield=this.game.add.sprite(0,0,"shield"),this.shield.anchor.setTo(.5,.5),this.shield.alpha=0,this.scale.setTo(1.2,1.2)):(Phaser.Sprite.call(this,t,e,i,"hero"),this.scale.setTo(.5,.5),this.alpha=.8,this.x=e,this.y=i,this.stateQueue=[],this.minQueueSize=10,this.maxQueueSize=30,this.previousStateTime=0),this.explosion=this.game.add.sprite(0,0,"explosion"),this.explosion.anchor.setTo(.5,.5),this.explosion.alpha=0,this.health=100,this.anchor.setTo(.5,.5),this.rotation=-Math.PI/2,this.game.physics.enable(this,Phaser.Physics.ARCADE)},t.Prefabs.Player.prototype=Object.create(Phaser.Sprite.prototype),t.Prefabs.Player.constructor=t.Prefabs.Player,t.Prefabs.Player.prototype.update=function(){this.target?this.updateHero():this.updateRemote()},t.Prefabs.Player.prototype.onUpdateFromServer=function(t){this.stateQueue.length>this.maxQueueSize&&this.stateQueue.splice(this.minQueueSize,this.maxQueueSize-this.minQueueSize),this.stateQueue.unshift(t)},t.Prefabs.Player.prototype.updateHero=function(){var t,e;this.follow?(t=this.game.math.distance(this.x,this.y,this.target.x,this.target.y),t>this.minDistance?(e=this.game.math.angleBetween(this.x,this.y,this.target.x,this.target.y),this.body.velocity.x=Math.cos(e)*this.speed*Math.min(t/120,2),this.body.velocity.y=Math.sin(e)*this.speed*Math.min(t/120,2),this.rotation=e):this.body.velocity.setTo(0,0)):this.body.velocity.setTo(0,0),this.shieldsEnabled&&(this.shield.x=this.x,this.shield.y=this.y,this.shield.rotation=this.rotation)},t.Prefabs.Player.prototype.updateRemote=function(){if(this.stateQueue.length>this.minQueueSize){var t=this.stateQueue.pop();this.previousStateTime||(this.previousStateTime=(new Date).getTime());var e=Math.abs(this.previousStateTime-(t.timestamp+10));this.game.add.tween(this).to({x:t.x,y:t.y,rotation:t.rotation},e,Phaser.Easing.Linear.None,!0,0),this.previousStateTime=t.timestamp}},t.Prefabs.Player.prototype.die=function(t){this.dead||(this.dead=!0,this.alpha=0,t||this.showExplosion())},t.Prefabs.Player.prototype.wasHitBy=function(t,e){return this.shieldsEnabled?void 0:(this.health-=10,this.health<=0?this.die():(this.enableShield(.3),this.showExplosion()),!0)},t.Prefabs.Player.prototype.showExplosion=function(){this.explosion.reset(this.x,this.y),this.explosion.alpha=0,this.explosion.scale.x=.2,this.explosion.scale.y=.2,this.game.add.tween(this.explosion).to({alpha:1,angle:"+30"},200,Phaser.Easing.Linear.NONE,!0,0).to({alpha:0,angle:"+30"},300,Phaser.Easing.Linear.NONE,!0,0),this.game.add.tween(this.explosion.scale).to({x:1.5,y:1.5},500,Phaser.Easing.Cubic.Out,!0,0)},t.Prefabs.Player.prototype.enableShield=function(t){this.shieldsEnabled=!0,this.timerShield&&!this.timerShield.expired&&this.timerShield.destroy(),this.timerShield=this.game.time.create(!0),this.timerShield.add(Phaser.Timer.SECOND*t,this.disableShield,this),this.timerShield.start(),this.game.add.tween(this.shield).to({alpha:1},300,Phaser.Easing.Cubic.Out,!0,0)},t.Prefabs.Player.prototype.disableShield=function(){this.game.add.tween(this.shield).to({alpha:0},300,Phaser.Easing.Linear.NONE,!0,0,6,!0).onComplete.add(function(){this.shieldsEnabled=!1},this)}};
},{}],9:[function(require,module,exports){
angular.module("app.game").directive("gameCanvas",["$window","mySocket","$injector",function(e,n,a){var i=function(i,t,o){var r=angular.element(e);r.bind("resize",function(e){}),n.then(function(e){require("./main.js")(t,i,e,i.ngModel,i.mapId,a)})};return{scope:{ngModel:"=",mapId:"="},template:'<div id="game-canvas"></div>',compile:function(e,n){return i}}}]);
},{"./main.js":14}],10:[function(require,module,exports){
angular.module("app.game").controller("GameController",["$scope","$stateParams","mySocket","User",function(e,a,l,o){e.players=[],e.mapId=a.id||"1",e.$on("game:getAvailablePlayers",function(a){e.players=a}),e.$on("$destroy",function(){e.$emit("player leaving")})}]);
},{}],11:[function(require,module,exports){
module.exports=angular.module("app.game",["ui.router","app.user"]).config(["$stateProvider",function(a){a.state("game",{url:"/game","abstract":!0,templateUrl:"/scripts/game/template.html"}).state("game.play",{url:"/:id",template:'<div>        <div id="gameCanvas" game-canvas="players" map-id="mapId"></div>      </div>',controller:"GameController",onEnter:function(a){a.playing=!0},onExit:function(a){a.playing=!1}})}]),require("./game_controller.js"),require("./game_canvas.js");
},{"./game_canvas.js":9,"./game_controller.js":10}],12:[function(require,module,exports){
"use strict";Phaser.Plugin.Juicy=function(e){Phaser.Plugin.call(this,e),this._boundsCache=Phaser.Utils.extend(!1,{},this.game.world.bounds),this._shakeWorldMax=20,this._shakeWorldTime=0,this._trailCounter=0,this._overScales={},this._overScalesCounter=0},Phaser.Plugin.Juicy.prototype=Object.create(Phaser.Plugin.prototype),Phaser.Plugin.Juicy.prototype.constructor=Phaser.Plugin.Juicy,Phaser.Plugin.Juicy.ScreenFlash=function(e,t){t=t||"white";var s=e.add.bitmapData(e.width,e.height);s.ctx.fillStyle="white",s.ctx.fillRect(0,0,e.width,e.height),Phaser.Sprite.call(this,e,0,0,s),this.alpha=0},Phaser.Plugin.Juicy.ScreenFlash.prototype=Object.create(Phaser.Sprite.prototype),Phaser.Plugin.Juicy.ScreenFlash.prototype.constructor=Phaser.Plugin.Juicy.ScreenFlash,Phaser.Plugin.Juicy.ScreenFlash.prototype.flash=function(e,t){e=e||1,t=t||100;var s=this.game.add.tween(this).to({alpha:e},100,Phaser.Easing.Bounce.InOut,!0,0,0,!0);s.onComplete.add(function(){this.alpha=0},this)},Phaser.Plugin.Juicy.Trail=function(e,t,s){Phaser.Graphics.call(this,e,0,0),this.target=null,this.trailLength=t||100,this.trailWidth=15,this.trailScaling=!1,this.trailColor=s||16777215,this._segments=[],this._verts=[],this._indices=[]},Phaser.Plugin.Juicy.Trail.prototype=Object.create(Phaser.Graphics.prototype),Phaser.Plugin.Juicy.Trail.prototype.constructor=Phaser.Plugin.Juicy.Trail,Phaser.Plugin.Juicy.Trail.prototype.update=function(){this.target&&(this.x=this.target.x,this.y=this.target.y,this.addSegment(this.target.x,this.target.y),this.redrawSegments(this.target.x,this.target.y))},Phaser.Plugin.Juicy.Trail.prototype.addSegment=function(e,t){for(var s;this._segments.length>this.trailLength;)s=this._segments.shift();s||(s=new Phaser.Point),s.x=e,s.y=t,this._segments.push(s)},Phaser.Plugin.Juicy.Trail.prototype.redrawSegments=function(e,t){this.clear();var s,i,a,h,r=0,n=0,o=0;this._verts.length!==4*(this._segments.length-1)&&(this._verts=[]);for(var l=0;l<this._segments.length;++l){if(s=this._segments[l],i){h=Math.atan2(s.y-i.y,s.x-i.x)+Math.PI/2,n=Math.sin(h),o=Math.cos(h);for(var c=0;2>c;++c)a=(-.5+c/1)*this.trailWidth,this.trailScaling&&(a*=l/this._segments.length),this._verts[r++]=s.x+o*a-e,this._verts[r++]=s.y+n*a-t}i=s.copyTo({})}if(this._verts.length>=8){for(var u=0;u<this._verts.length;u++)this._indices[6*u+0]=2*u+0,this._indices[6*u+1]=2*u+1,this._indices[6*u+2]=2*u+2,this._indices[6*u+3]=2*u+1,this._indices[6*u+4]=2*u+2,this._indices[6*u+5]=2*u+3;this.beginFill(this.trailColor),this.drawTriangles(this._verts,this._indices),this.endFill()}},Phaser.Plugin.Juicy.prototype.shake=function(e,t){this._shakeWorldTime=e||20,this._shakeWorldMax=t||20,this.game.world.setBounds(this._boundsCache.x-this._shakeWorldMax,this._boundsCache.y-this._shakeWorldMax,this._boundsCache.width+this._shakeWorldMax,this._boundsCache.height+this._shakeWorldMax)},Phaser.Plugin.Juicy.prototype.createScreenFlash=function(e){return new Phaser.Plugin.Juicy.ScreenFlash(this.game,e)},Phaser.Plugin.Juicy.prototype.createTrail=function(e,t){return new Phaser.Plugin.Juicy.Trail(this.game,e,t)},Phaser.Plugin.Juicy.prototype.overScale=function(e,t,s){t=t||1.5;var i=this._overScalesCounter++;s=s||new Phaser.Point(1,1);var a=this._overScales[i];a||(a={object:e,cache:s.copyTo({})}),a.scale=t,this._overScales[i]=a},Phaser.Plugin.Juicy.prototype.jelly=function(e,t,s,i){t=t||.2,s=s||0,i=i||new Phaser.Point(1,1),this.game.add.tween(e.scale).to({x:i.x+i.x*t},50,Phaser.Easing.Quadratic.InOut,!0,s).to({x:i.x},600,Phaser.Easing.Elastic.Out,!0),this.game.add.tween(e.scale).to({y:i.y+i.y*t},50,Phaser.Easing.Quadratic.InOut,!0,s+50).to({y:i.y},600,Phaser.Easing.Elastic.Out,!0)},Phaser.Plugin.Juicy.prototype.mouseStretch=function(e,t,s){t=t||.5,s=s||new Phaser.Point(1,1),e.scale.x=s.x+Math.abs(e.x-this.game.input.activePointer.x)/100*t,e.scale.y=s.y+s.y*t-e.scale.x*t},Phaser.Plugin.Juicy.prototype.update=function(){var e;if(this._shakeWorldTime>0){var t=this._shakeWorldTime/this._shakeWorldMax*this._shakeWorldMax,s=this.game.rnd.integerInRange(-t,t),i=this.game.rnd.integerInRange(-t,t);this.game.camera.x=s,this.game.camera.y=i,this._shakeWorldTime--,this._shakeWorldTime<=0&&this.game.world.setBounds(this._boundsCache.x,this._boundsCache.x,this._boundsCache.width,this._boundsCache.height)}for(var a in this._overScales)this._overScales.hasOwnProperty(a)&&(e=this._overScales[a],e.scale>.01?(e.object.scale.x=e.scale*e.cache.x,e.object.scale.y=e.scale*e.cache.y,e.scale-=this.game.time.elapsed*e.scale*.35):(e.object.scale.x=e.cache.x,e.object.scale.y=e.cache.y,delete this._overScales[a]))},module&&module.exports&&(module.exports=Phaser.Plugin.Juicy),Phaser.Graphics.prototype.drawTriangle||(Phaser.Graphics.prototype.drawTriangle=function(e,t){var s=new Phaser.Polygon(e);if(t){var i=new Phaser.Point(this.game.camera.x-e[0].x,this.game.camera.y-e[0].y),a=new Phaser.Point(e[1].x-e[0].x,e[1].y-e[0].y),h=new Phaser.Point(e[1].x-e[2].x,e[1].y-e[2].y),r=h.cross(a);i.dot(r)>0&&this.drawPolygon(s)}else this.drawPolygon(s)},Phaser.Graphics.prototype.drawTriangles=function(e,t,s){var i,a=new Phaser.Point,h=new Phaser.Point,r=new Phaser.Point,n=[];if(t)if(e[0]instanceof Phaser.Point)for(i=0;i<t.length/3;i++)n.push(e[t[3*i]]),n.push(e[t[3*i+1]]),n.push(e[t[3*i+2]]),3===n.length&&(this.drawTriangle(n,s),n=[]);else for(i=0;i<t.length;i++)a.x=e[2*t[i]],a.y=e[2*t[i]+1],n.push(a.copyTo({})),3===n.length&&(this.drawTriangle(n,s),n=[]);else if(e[0]instanceof Phaser.Point)for(i=0;i<e.length/3;i++)this.drawTriangle([e[3*i],e[3*i+1],e[3*i+2]],s);else for(i=0;i<e.length/6;i++)a.x=e[6*i+0],a.y=e[6*i+1],h.x=e[6*i+2],h.y=e[6*i+3],r.x=e[6*i+4],r.y=e[6*i+5],this.drawTriangle([a,h,r],s)});
},{}],13:[function(require,module,exports){
(function(){function r(r,e,n){var t=e&&n||0,u=0;for(e=e||[],r.toLowerCase().replace(/[0-9a-f]{2}/g,function(r){16>u&&(e[t+u++]=v[r])});16>u;)e[t+u++]=0;return e}function e(r,e){var n=e||0,t=l;return t[r[n++]]+t[r[n++]]+t[r[n++]]+t[r[n++]]+"-"+t[r[n++]]+t[r[n++]]+"-"+t[r[n++]]+t[r[n++]]+"-"+t[r[n++]]+t[r[n++]]+"-"+t[r[n++]]+t[r[n++]]+t[r[n++]]+t[r[n++]]+t[r[n++]]+t[r[n++]]}function n(r,n,t){var u=n&&t||0,o=n||[];r=r||{};var a=null!=r.clockseq?r.clockseq:m,f=null!=r.msecs?r.msecs:(new Date).getTime(),i=null!=r.nsecs?r.nsecs:w+1,c=f-g+(i-w)/1e4;if(0>c&&null==r.clockseq&&(a=a+1&16383),(0>c||f>g)&&null==r.nsecs&&(i=0),i>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");g=f,w=i,m=a,f+=122192928e5;var s=(1e4*(268435455&f)+i)%4294967296;o[u++]=s>>>24&255,o[u++]=s>>>16&255,o[u++]=s>>>8&255,o[u++]=255&s;var l=f/4294967296*1e4&268435455;o[u++]=l>>>8&255,o[u++]=255&l,o[u++]=l>>>24&15|16,o[u++]=l>>>16&255,o[u++]=a>>>8|128,o[u++]=255&a;for(var v=r.node||p,d=0;6>d;d++)o[u+d]=v[d];return n?n:e(o)}function t(r,n,t){var o=n&&t||0;"string"==typeof r&&(n="binary"==r?new s(16):null,r=null),r=r||{};var a=r.random||(r.rng||u)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,n)for(var f=0;16>f;f++)n[o+f]=a[f];return n||e(a)}var u,o=this;if("function"==typeof o.require)try{var a=o.require("crypto").randomBytes;u=a&&function(){return a(16)}}catch(f){}if(!u&&o.crypto&&crypto.getRandomValues){var i=new Uint8Array(16);u=function(){return crypto.getRandomValues(i),i}}if(!u){var c=new Array(16);u=function(){for(var r,e=0;16>e;e++)0===(3&e)&&(r=4294967296*Math.random()),c[e]=r>>>((3&e)<<3)&255;return c}}for(var s="function"==typeof o.Buffer?o.Buffer:Array,l=[],v={},d=0;256>d;d++)l[d]=(d+256).toString(16).substr(1),v[l[d]]=d;var y=u(),p=[1|y[0],y[1],y[2],y[3],y[4],y[5]],m=16383&(y[6]<<8|y[7]),g=0,w=0,h=t;if(h.v1=n,h.v4=t,h.parse=r,h.unparse=e,h.BufferClass=s,"function"==typeof define&&define.amd)define(function(){return h});else if("undefined"!=typeof module&&module.exports)module.exports=h;else{var q=o.uuid;h.noConflict=function(){return o.uuid=q,h},o.uuid=h}}).call(this);
},{}],14:[function(require,module,exports){
module.exports=function(e,a,t,r,s,o){require("./lib/juicy");var d=(require("./lib/uuid"),parseInt(e.css("height"),10)),n=parseInt(e.css("width"),10),i=new Phaser.Game(n,d,Phaser.AUTO,"game-canvas"),l=require("./states"),c=l.States;i.state.add("Boot",c.Boot),i.state.add("Preloader",c.Preloader),i.state.add("MainMenu",c.MainMenu),i.state.add("Play",c.Play),i.state.add("GameOver",c.GameOver),i.mapId=s,i.socket=t,i.scope=a,l.maps=r,l.remotePlayers=[];var m=o.get("User"),u=l;u.socket=t,u.mapId=s,u.currentPlayer=m.getCurrentUser(),a.$on("game:toggleMusic",function(){i.state.states.Preloader.toggleMusic()}),a.$on("$destroy",function(){t.emit("playerLeftMap",{playerId:u.sid,mapId:u.mapId}),i.destroy()}),l.connected=!0,console.log("connected data data",t,u.currentPlayer),u.playerName="Ari",u.socket.emit("setPlayerName",{name:u.playerName}),u.socket.on("playerDetails",function(e){u.sid=e.id,console.log("GAME GAME",i),i.state.start("Boot")})};
},{"./lib/juicy":12,"./lib/uuid":13,"./states":17}],15:[function(require,module,exports){
module.exports=function(e){e.States.Boot=function(e){},e.States.Boot.prototype={resizeCanvasToContainerElement:function(){var a=this.game.canvas,a=this.game.canvas,s=a.clientWidth,t=a.clientHeight,i=s/this.width,h=t/this.height,n=Math.min(i,h);this.scale.width=n*this.game.width,this.scale.height=n*this.game.height,this.scale.setSize(s,t),e.width=this.game.width,e.height=this.game.height},init:function(){this.input.maxPointers=1,this.stage.disableVisibilityChange=!0,this.game.device.desktop?this.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL:(this.game.stage.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.stage.scale.minWidth=480,this.game.stage.scale.minHeight=260,this.game.stage.scale.maxWidth=640,this.game.stage.scale.maxHeight=480,this.game.stage.scale.forceLandscape=!0,this.game.stage.scale.pageAlignHorizontally=!0),this.scale.setResizeCallback(this.handleResizeEvent,this),this.scale.setScreenSize(!0),this.scale.refresh()},preload:function(){this.load.image("menu_background","assets/menu_background.jpg"),this.load.image("preloader","assets/preloader.gif"),this.load.json("levels","assets/levels.json")},create:function(){this.game.device.desktop?(this.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.stage.scale.pageAlignHorizontally=!0):(this.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.scale.forceLandscape=!1,this.scale.pageAlignHorizontally=!0),this.resizeCanvasToContainerElement(),e.initialized=!0,this.state.start("Preloader")},handleResizeEvent:function(){this.resizeCanvasToContainerElement()}}};
},{}],16:[function(require,module,exports){
module.exports=function(e){e.States.GameOver=function(e){},e.States.GameOver.prototype.create=function(){e.multiplayer&&(this.gameoverPanel=new e.Prefabs.GameoverPanel(this.game),this.game.add.existing(this.gameoverPanel),this.gameoverPanel.show(e.score))}};
},{}],17:[function(require,module,exports){
var Game={name:"ng-invader",States:{},Prefabs:{},Levels:{},orientated:!0,backgroundX:0,backgroundY:0,paused:!0,multiplayer:!0,mapData:{},socket:{},remotePlayers:[],toAdd:[],toRemove:[],latency:0,width:800,height:600,cpc:function(e){return 64*e+32},playerById:function(e){for(var r=0;r<this.remotePlayers.length;r++)if(this.remotePlayers[r].id===e)return this.remotePlayers[r];return!1},resetCallbacks:[],reset:function(){_.map(Game.resetCallbacks,function(e,r){Game.resetCallbacks[e].apply(this)})},winner:!1};require("../entities")(Game),require("./boot")(Game),require("./preloader")(Game),require("./mainmenu")(Game),require("./play")(Game),require("./game_over")(Game),module.exports=Game;
},{"../entities":5,"./boot":15,"./game_over":16,"./mainmenu":18,"./play":19,"./preloader":20}],18:[function(require,module,exports){
module.exports=function(t){t.States.MainMenu=function(t){this.juicy,this.screenFlash},t.States.MainMenu.prototype={create:function(){var t=this.game;this.startTime=t.time.now;var e=this.game.cache.getImage("logo"),i=this.world.centerX,a=this.world.centerY-e.height,s=(this.world.height+e.height,this.game.device.desktop?60:30);this.background=t.add.tileSprite(0,0,this.world.width,this.world.height,"menu_background"),this.background.autoScroll(-50,-20),this.background.tilePosition.x=0,this.background.tilePosition.y=0;var n=t.add.sprite(i,a-s,"logo");n.anchor.set(.5),this.game.device.desktop&&n.scale.set(2);var h=this.game.device.desktop?"40px":"20px",o=this.newGame=this.add.text(this.world.centerX,a+s,"New game",{font:h+" Architects Daughter",align:"center",fill:"#fff"});o.inputEnabled=!0,o.anchor.set(.5),o.events.onInputOver.add(this.overNewgame,this),o.events.onInputOut.add(this.outNewgame,this),o.events.onInputDown.add(this.playGame,this);var u=this.multiGame=this.add.text(this.world.centerX,a+s+o.height,"New multiplayer game",{font:h+" Architects Daughter",align:"center",fill:"#fff"});u.inputEnabled=!0,u.anchor.set(.5),u.events.onInputOver.add(this.overMultigame,this),u.events.onInputOut.add(this.outMultigame,this),u.events.onInputDown.add(this.playMultiGame,this),this.juicy=t.plugins.add(Phaser.Plugin.Juicy),this.screenFlash=this.juicy.createScreenFlash(),this.add.existing(this.screenFlash),this.menu_music=t.add.audio("menu_music"),this.dink=t.add.audio("dink"),this.menu_music.play()},playGame:function(){t.multiplayer=!1,this.menu_music.stop(),this.game.state.start("Play")},playMultiGame:function(){t.multiplayer=!0,this.play()},overNewgame:function(){this.game.add.tween(this.newGame.scale).to({x:1.3,y:1.3},300,Phaser.Easing.Exponential.Out,!0),this.dink.play()},overMultigame:function(){this.game.add.tween(this.multiGame.scale).to({x:1.3,y:1.3},300,Phaser.Easing.Exponential.Out,!0),this.dink.play()},outMultigame:function(){this.game.add.tween(this.multiGame.scale).to({x:1,y:1},300,Phaser.Easing.Exponential.Out,!0),this.dink.play()},outNewgame:function(){this.game.add.tween(this.newGame.scale).to({x:1,y:1},300,Phaser.Easing.Exponential.Out,!0)}}};
},{}],19:[function(require,module,exports){
module.exports=function(e){var t=e;e.States.Play=function(e){},e.States.Play.prototype={create:function(){var i=this.game;this.level=e.currentLevel||0,this.levelData=e.Levels[this.level],this.points=0,this.background=this.game.add.tileSprite(0,0,this.game.width,this.game.height,"background"+this.level),this.background.autoScroll(1,15),this.background.tilePosition.x=e.backgroundX,this.background.tilePosition.y=e.backgroundY,this.game.add.tween(this.background).to({alpha:.3},5e3,Phaser.Easing.Linear.NONE,!0,0,Number.POSITIVE_INFINITY,!0),this.game.time.advancedTiming=!0,this.fpsText=this.game.add.text(100,this.game.height-26,"",{font:"16px Arial",fill:"#ffffff"}),this.lasers=i.add.group(),this.enemyGroups={},this.enemyGroupsCount=0;for(var s=this.levelData.enemies,a=0;a<=s.length;a++)this.enemyGroups[a]=i.add.group(),this.enemyGroupsCount++;this.score=0,this.bullets=i.add.group(),this.remoteBullets=i.add.group(),t.remotePlayers=i.remotePlayers||[],this.game.input.onDown.add(this.shootBullet,this),t.sio=t.socket,t.hero=this.hero=new e.Prefabs.Player(this.game,this.game.width/2,this.game.height+60+20,this.game.input,!0,t.sio),this.game.add.existing(this.hero),this.livesGroup=this.game.add.group(),this.livesGroup.add(this.game.add.sprite(0,0,"lives")),this.livesGroup.add(this.game.add.sprite(20,3,"num",0)),this.livesNum=this.game.add.sprite(35,3,"num",this.hero.lives+1),this.livesGroup.add(this.livesNum),this.livesGroup.x=this.game.width-55,this.livesGroup.y=5,this.livesGroup.alpha=0;for(var a=0;a<this.hero.numBullets;a++){var h=new e.Prefabs.Bullet(this.game,0,0,this.hero);this.bullets.add(h)}this.score=0,this.scoreText=this.game.add.bitmapText(10,this.game.height-27,"architectsDaughter","Score: 0",16),this.scoreText.alpha=0,this.juicy=this.game.plugins.add(Phaser.Plugin.Juicy),this.screenFlash=this.juicy.createScreenFlash(),this.add.existing(this.screenFlash),this.game_music=i.add.audio("game_music"),this.timerInit=this.game.time.create(!0),this.timerInit.add(1.5*Phaser.Timer.SECOND,this.initGame,this),this.timerInit.start();var r=this,o=_.extend(this.hero,{id:t.sid,name:"You joined"});if(r.game.scope.$emit("game:newPlayer",o),e.multiplayer){var l=function(i,s){t.remotePlayers.splice(t.remotePlayers.indexOf(i),1),e.toRemove.push(i),r.game.scope.$emit("game:removePlayer",{player:i,mapId:s})};this.game.socket.on("gameUpdated:add",function(i){console.log("gameUpdated:add");for(var s=i.allPlayers,a=0;a<s.length;a++){var h=s[a];h.id===t.hero.id||e.playerById(h.id)||(t.toAdd.push(h),r.game.scope.$emit("game:newPlayer",h))}}),this.game.socket.on("gameUpdated:remove",function(e){for(var i=t.remotePlayers,s=e.allPlayers,a=e.map,h=0;h<i.length;h++){var r=i[h];if(r.id===t.hero.id);else{for(var o=!1,h=0;h<s.length;h++)s[h].id===r.id&&(o=!0);o||l(r,a)}}}),this.game.socket.on("updatePlayers",function(i){for(var s=i.game.players,a=0;a<s.length;a++){var h,r=s[a];r.id!==t.sid&&(h=e.playerById(r.id),h&&h.onUpdateFromServer(r))}}),this.game.socket.on("bulletShot",function(t){var i=e.playerById(t.id);i&&(h=r.remoteBullets.getFirstExists(!1),h||(h=new e.Prefabs.Bullet(this.game,t.x,t.y,i),r.remoteBullets.add(h)),h.shoot(),h.reset(t.x,t.y))}),this.game.socket.on("playerHit",function(i){if(i.victim===t.sid)0===i.victimHealth&&r.gameOver();else{var s=e.playerById(i.victim);s&&i.victimHealth<=0&&s.die()}}),this.game.socket.on("gameOver",function(i){var s=i.winner.id;s===t.sid?e.winner=!0:e.winner=!1,r.gameOver()}),t.socket.emit("newPlayer",{mapId:e.mapId,health:this.hero.health})}},update:function(){e.paused||(this.addPlayers(),this.removePlayers(),this.checkCollisions(),this.fpsText.setText(this.game.time.fps+" FPS"))},updateRemoteServer:function(){this.game;t.socket.emit("updatePlayer",{x:this.hero.x,y:this.hero.y,xRel:this.hero.x/(0===e.width?1:e.width),yRel:this.hero.y/(0===e.height?1:e.height),health:this.hero.health,rotation:this.hero.rotation,timestamp:(new Date).getTime()}),this.updateRemoteServerTimer=this.game.time.events.add(20,this.updateRemoteServer,this)},addPlayers:function(){for(;0!==t.toAdd.length;){var e=t.toAdd.shift();if(e){var i=this.addPlayer(e.x,e.y,e.id);t.remotePlayers.push(i)}}},addPlayer:function(t,i,s){var a=new e.Prefabs.Player(this.game,this.game.width/2,100,null,s);return this.game.add.existing(a),a},removePlayers:function(){for(;0!==t.toRemove.length;){var e=t.toRemove.shift();this.game.world.removeChild(e,!0)}},shutdown:function(){this.bullets.destroy(),this.forEachEnemy(function(e){e.destroy()}),this.lasers.destroy(),e.paused=!0},goToMenu:function(){e.backgroundX=this.background.tilePosition.x,e.backgroundY=this.background.tilePosition.y,this.game.state.start("MainMenu")},initGame:function(){this.updateRemoteServerTimer=this.game.time.events.add(200,this.updateRemoteServer,this),this.playGame()},playGame:function(){e.paused&&(e.paused=!1,this.hero.follow=!0,this.hero.body.collideWorldBounds=!0,this.lasers.forEach(function(e){e.resume()},this),this.game.input.x=this.hero.x,this.game.input.y=this.hero.y)},generateEnemies:function(){for(var t=this.levelData.enemies,i=0;i<t.length;i++){var s=this.enemyGroups[i],a=t[i],h=s.getFirstExists(!1);h||(h=new e.Prefabs.Enemies(this.game,a.count||10,a,this.hero,this.enemyGroups[i])),h.reset(this.game.rnd.integerInRange(0,this.game.width),this.game.rnd.integerInRange(0,this.game.width))}this.enemiesGenerator=this.game.time.events.add(500*this.game.rnd.integerInRange(20,50)/(this.level+1),this.generateEnemies,this)},shootBullet:function(){if(void 0===this.lastBulletShotAt&&(this.lastBulletShotAt=0),!(this.game.time.now-this.lastBulletShotAt<this.hero.shotDelay)){this.lastBulletShotAt=this.game.time.now;var e;e=this.bullets.getFirstExists(!1),e&&(e.reset(this.hero.x,this.hero.y),e.shoot(),this.game.socket.emit("shotbullet",{id:t.sid,y:e.y,x:e.x,rotation:e.rotation}))}},checkCollisions:function(){if(e.multiplayer)this.game.physics.arcade.overlap(this.remoteBullets,this.hero,this.killHero,null,this),t.remotePlayers.forEach(function(e){this.game.physics.arcade.overlap(this.bullets,e,this.hitARemotePlayer,null,this)},this);else{for(var i=this.enemyGroups,s=0;s<this.enemyGroupsCount;s++){var a=i[s];a.forEach(function(e){this.game.physics.arcade.overlap(this.bullets,e,this.killEnemy,null,this)},this),a.forEach(function(e){this.game.physics.arcade.overlap(this.hero,e,this.killHero,null,this)},this)}this.game.physics.arcade.overlap(this.hero,this.lasers,this.killHero,null,this),this.game.physics.arcade.overlap(this.hero,this.bonus,this.activeBonus,null,this)}},updateScore:function(e){this.score+=e.desc?e.desc.maxHealth:1,this.scoreText.setText("Score: "+this.score)},killEnemy:function(e,t){!t.dead&&t.checkWorldBounds&&(t.die(),e.kill(),this.updateScore(t))},killHero:function(i,s){if(s instanceof e.Prefabs.Laser||s instanceof e.Prefabs.Enemy&&!s.dead&&s.checkWorldBounds)this.hero.lives--,this.screenFlash.flash(),this.hero.lives<1?this.gameOver():(this.hero.enableShield(2),this.game.add.tween(this.livesNum).to({alpha:0,y:8},200,Phaser.Easing.Exponential.Out,!0).onComplete.add(function(){this.livesNum.frame=this.hero.lives+1,this.livesNum.y=-2,this.game.add.tween(this.livesNum).to({alpha:1,y:3},200,Phaser.Easing.Exponential.Out,!0)},this));else if(s instanceof e.Prefabs.Bullet){var a=s,h=a.player;a.kill(),this.hero.wasHitBy(a,h)&&(this.screenFlash.flash(),this.game.socket.emit("playerHit",{shooter:h.id,victim:t.sid,health:this.hero.health})),this.hero.health<0&&this.gameOver()}},hitARemotePlayer:function(e,t){e.shieldsEnabled||e.showExplosion(),t.kill()},shootLaser:function(){var t=this.lasers.getFirstExists(!1);t||(t=new e.Prefabs.Laser(this.game,0,0),this.lasers.add(t)),t.reset(this.game.width+t.width/2,this.game.rnd.integerInRange(20,this.game.height)),t.reload(100+30*(this.level+1)),this.lasersGenerator=this.game.time.events.add(250*this.game.rnd.integerInRange(12,20)/(this.level+1),this.shootLaser,this)},gameOver:function(){this.game.input.onDown.removeAll(),this.gameover=!0,this.juicy.shake(20,5),this.game.add.tween(this.hero).to({alpha:0},500,Phaser.Easing.Exponential.Out,!0),this.scoreText.alpha=0,this.livesGroup.alpha=0,this.pauseGame(),this.game.socket.removeAllListeners(),this.state.start("GameOver")},forEachEnemy:function(e){for(var t=this.enemyGroups,i=0;i<this.enemyGroupsCount;i++){var s=t[i];s.forEach(e,this)}},pauseGame:function(){e.paused||(e.paused=!0,this.hero.follow=!1,e.multiplayer||(this.enemiesGenerator.timer.pause(),this.forEachEnemy(function(e){e.callAll("pause")}),this.lasers.forEach(function(e){e.pause()},this)),!this.gameover)}}};
},{}],20:[function(require,module,exports){
module.exports=function(e){e.States.Preloader=function(e){this.asset=null,this.ready=!1,WebFontConfig={google:{families:["Revalia","Architects Daughter"]}}},e.States.Preloader.prototype={preload:function(){this.load.onLoadComplete.addOnce(this.onLoadComplete,this),this.asset=this.add.sprite(this.world.centerX,this.world.centerY,"preloader"),this.asset.anchor.setTo(.5,.5),this.load.setPreloadSprite(this.asset);var s=e.Levels=this.game.cache.getJSON("levels");for(var a in s){var t=s[a];this.load.image("background"+a,t.background)}this.game.load.script("webfont","//ajax.googleapis.com/ajax/libs/webfont/1.4.7/webfont.js"),this.load.image("logo","assets/logo.png"),this.load.image("hero","assets/player_blue.png"),this.load.image("shield","assets/shield.png"),this.load.image("player_green","assets/player_green.png"),this.load.image("laser_red","assets/laser_red.png"),this.load.image("laser_yellow","assets/laser_yellow.png"),this.load.image("laser_orange","assets/laser_orange.png"),this.load.image("laser_gray","assets/laser_gray.png"),this.load.image("enemy_1","assets/enemy_1.png"),this.load.image("enemy_2","assets/enemy_2.png"),this.load.image("enemy_3","assets/enemy_3.png"),this.load.image("next_level","assets/levelcomplete-bg.png"),this.load.image("gameover","assets/gameover-bg.png"),this.load.image("new","assets/new.png"),this.load.spritesheet("btnMenu","assets/btn-menu.png",190,49,2),this.load.spritesheet("btn","assets/btn.png",49,49,6),this.load.spritesheet("num","assets/num.png",12,11,5),this.load.spritesheet("bonus","assets/bonus.png",16,16,2),this.load.image("num","assets/num.png"),this.load.image("lives","assets/lives.png"),this.load.image("panel","assets/panel.png"),this.load.image("laser","assets/laser.png"),this.load.image("bullet","assets/bullet.png"),this.load.audio("laserFx","assets/laser_01.mp3"),this.load.audio("dink","assets/dink.mp3"),this.load.audio("menu_music","assets/menu_music.mp3"),this.load.audio("game_music","assets/game_music.mp3"),this.load.spritesheet("explosion","assets/explode.png",128,128,16),this.load.bitmapFont("architectsDaughter","assets/fonts/r.png","assets/fonts/r.fnt"),e.currentLevel=0,localStorage.getItem("currentLevel")&&(e.currentLevel=localStorage.getItem("currentLevel"))},create:function(){this.asset.cropEnabled=!1,this.game.stage.backgroundColor=2833986;var s=this.add.tween(this.asset).to({alpha:0},500,Phaser.Easing.Linear.None,!0);s.onComplete.add(this.startMainMenu,this);var a=this.game;e.cursors=a.input.keyboard.createCursorKeys()},startMainMenu:function(){this.ready&&(e.mapId?this.game.state.start("Play"):this.game.state.start("MainMenu"))},toggleMusic:function(){(this.musicIsPlaying=!this.musicIsPlaying)?music.stop():music.play("")},onLoadComplete:function(){this.ready=!0}}};
},{}],21:[function(require,module,exports){
angular.module("app",["ui.router",require("./menu").name,require("./game").name,require("./user").name,require("./navbar").name,require("./overlay").name,require("./network").name]).config(["$urlRouterProvider",function(e){e.otherwise("/menu")}]);
},{"./game":11,"./menu":22,"./navbar":25,"./network":28,"./overlay":32,"./user":35}],22:[function(require,module,exports){
module.exports=angular.module("app.menu",[require("./play_button").name]).config(["$stateProvider",function(e){e.state("menu",{"abstract":!0,templateUrl:"scripts/menu/template.html",url:"/menu"}).state("menu.home",{url:"",templateUrl:"scripts/menu/main.html",controller:"MenuController as ctrl",onEnter:function(e){e.queryForRooms()}})}]),require("./menu_controller");
},{"./menu_controller":23,"./play_button":24}],23:[function(require,module,exports){
angular.module("app.menu").controller("MenuController",["mySocket","$scope","Room",function(o,e,n){e.$on("map:update",function(o,e){t.rooms=n.getRooms()});var t=this;t.createId=function(){return(new Date).getTime().toString()}}]);
},{}],24:[function(require,module,exports){
module.exports=angular.module("app.menu.playButton",[]).directive("playButton",function(){return{scope:{onClick:"&"},template:'<div class="playButton"        ng-click="onClick()">      <i class="icon ion-play"></i>      <span class="play-text">play</span>    </div>'}});
},{}],25:[function(require,module,exports){
module.exports=angular.module("app.navbar",[]).directive("navbar",function(){return{restrict:"A",replace:!0,templateUrl:"scripts/navbar/navbar.html",controller:"NavbarController"}}),require("./navbar_controller");
},{"./navbar_controller":26}],26:[function(require,module,exports){
angular.module("app.navbar").controller("NavbarController",["$scope","Game","players",function(e,n,a){e.connectedPlayers=[],e.game=n,e.$on("newPlayers",function(n,a){e.connectedPlayers=a})}]);
},{}],27:[function(require,module,exports){
angular.module("app.network").factory("FeedItem",function(){var e=function(e,n){this.id=n.id,this.eventName=e,this.msg=n.name||e+" happened"};return e}).service("feed",["mySocket","$rootScope","FeedItem",function(e,n,t){var i=this,a=[];this.list=a,this.maxLength=10;var o=function(e,o){n.$apply(function(){var n=new t(e,o);a.unshift(n),a.length>i.maxLength&&a.splice(i.maxLength,a.length-i.maxLength)})};n.$on("game:removePlayer",function(e,n){}),e.then(function(e){e.on("newPlayer",function(e){o("join",e)}),e.on("playerHit",function(e){o("playerHit",e)})})}]);
},{}],28:[function(require,module,exports){
require("./ioLoader"),module.exports=angular.module("app.network",["btford.socket-io","app.loader"]).config(["ioLoaderProvider",function(e){console.log("ioLoader",e)}]),require("./ws"),require("./players"),require("./feed");
},{"./feed":27,"./ioLoader":29,"./players":30,"./ws":31}],29:[function(require,module,exports){
"use strict";angular.module("app.loader",[]).provider("ioLoader",function(){this.scriptUrl=window.location.origin+"/socket.io/socket.io.js",this.$get=["$window","$document","$q",function(e,t,r){var i=r.defer(),o=this.scriptUrl;return{done:function(){var r=function(){return i.resolve(e.io)};if(e.io)r();else{var n=t[0].createElement("script");n.type="text/javascript",n.async=!0,n.src=o,n.onreadystatechange=function(){"complete"===this.readyState?r():i.reject()},n.onload=r;var a=t[0].getElementsByTagName("head")[0];a.appendChild(n)}return i.promise}}}],this.setScriptUrl=function(e){this.scriptUrl=e}});
},{}],30:[function(require,module,exports){
angular.module("app.network").factory("Player",function(){var e=function(e){this.id=e.id,this.name=e.name};return e}).service("players",["mySocket","$rootScope","Player","Room",function(e,n,a,o){var r=[],t=function(e){for(var n=0;n<r.length;n++)if(r[n].id===e)return r[n]};e.then(function(e){e.on("gameOver",function(e){n.$apply(function(){r=[]})}),e.on("map:update",function(e){console.log("players map:update",e)})}),n.$on("game:removePlayer",function(e,a){var o=t(a.id),i=r.indexOf(o);console.log("game:removePlayer players player",a.id,_.map(r,"id")),r.splice(i,1),n.$broadcast("newPlayers",r)}),n.$on("game:newPlayer",function(e,o){var t=new a(o);r.push(t),n.$broadcast("newPlayers",r)})}]);
},{}],31:[function(require,module,exports){
angular.module("app.network").factory("mySocket",["ioLoader","$q","socketFactory","User",function(e,o,r,n){var t=o.defer();return e.done().then(function(e){var o=e.connect(),n=r({ioSocket:o});t.resolve(n)}),t.promise}]);
},{}],32:[function(require,module,exports){
module.exports=angular.module("app.overlay",[]).directive("overlayBar",function(){return{templateUrl:"/scripts/overlay/overlay.html",controller:"OverlayController as ctrl"}}),require("./overlay_controller.js");
},{"./overlay_controller.js":33}],33:[function(require,module,exports){
angular.module("app.overlay").controller("OverlayController",["$rootScope","$scope","players","feed",function(e,o,l,r){var t=this;t.turnOffMusic=function(){e.$broadcast("game:toggleMusic")},t.title="Feed",t.feed=r.list,t.feedLimit=10,o.$on("newPlayers",function(e,l){o.players=l})}]);
},{}],34:[function(require,module,exports){
angular.module("app.user").service("Game",function(){this.playing=!1});
},{}],35:[function(require,module,exports){
module.exports=angular.module("app.user",[]),require("./user_service"),require("./room_service"),require("./game_service");
},{"./game_service":34,"./room_service":36,"./user_service":37}],36:[function(require,module,exports){
angular.module("app.user").service("Room",["$rootScope","$q","mySocket",function(a,o,n){var e=this,r=[];this.queryForRooms=function(){n.then(function(a){a.emit("getMaps")})},n.then(function(o){o.on("getAllMaps",function(o){r=o,a.$broadcast("map:update")}),o.on("global:newPlayer",function(a){var o=a.map,n=t(o);n&&n.players.push(a.player)}),o.on("newMapCreated",function(o){r.push(o),a.$broadcast("map:update",o)}),o.on("gameOver",function(a){var o=a.mapId,n=t(o);console.log("gameOver",a,n)}),o.on("global:playerLeftMap",function(o){var n=o.mapId,e=t(n);if(e){var r=u(o.id,e);e.players.splice(r,1)}a.$broadcast("map:update",e)}),o.on("global:removeMap",function(o){var n=o.mapId,r=t(n);r&&e.queryForRooms(),a.$broadcast("map:update",r)})}),this.getRooms=function(){return r},this.getRoom=function(a){return t(a)};var t=function(a){for(var o=0;o<r.length;o++)if(r[o].id===a)return r[o];return!1},u=function(a,o){for(var n=0;n<o.players.length;n++){var e=o.players[n];if(e.id===a)return n}}}]);
},{}],37:[function(require,module,exports){
angular.module("app.user").service("User",function(){var r=localStorage.getItem("currentUser");r&&(r=JSON.parse(r)),this.setCurrentUser=function(e){localStorage.setItem("currentUser",JSON.stringify(e)),r=e},this.getCurrentUser=function(){return r},this.modifyCurrentUser=function(e){var t=this.getCurrentUser();if(t){for(var s in e)t[s]=e[s];this.setCurrentUser(t)}else this.setCurrentUser(e);return r}});
},{}]},{},[21])